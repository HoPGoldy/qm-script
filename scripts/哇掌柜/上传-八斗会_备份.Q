[General]
SyntaxVersion=2
BeginHotkey=0
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=121
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=95416690-f86f-4ffb-88c8-9e1ac3ec584c
Description=上传-八斗会_备份
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=updateForm
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
Event updateForm.LoadOver
	Call Lib.hps.createNewFolder("D:\DATA\资料\update\data")
	Call Lib.hps.createNewFolder("D:\DATA\资料\picDownload")
	
	updateForm.infoBox.Text = " "
    fileExist = Plugin.File.ExistFile("D:\DATA\资料\update\data\info")
    If fileExist = 2 Then 
    	If CInt(load("picFinshed", "info")) = 0 Then 
    		doingWork = CInt(load("doingWork", "info"))
    		Call showLog("已读取第" & (doingWork + 1) & "个条目")
    		updateForm.run.Caption = "下载图片"
    		Call initWork(doingWork)
    	Else 
    		doingWork = CInt(load("doingWork", "info"))
        	Call showLog("已读取第" & (doingWork + 1) & "个条目")
        	updateForm.run.Caption = "上传条目"
        	Call initWork(doingWork)
    	End If
    Else 
        Call showLog("请复制作业并点击新建作业按钮")
        updateForm.run.Caption = "新建作业"
        updateForm.getLast.Enabled = False
        updateForm.getNext.Enabled = False
    End If
End Event

Event updateForm.run.Click
    BeginThread runClickEvent()
End Event

Sub runClickEvent()
    dataLoadSuccess = Plugin.File.ExistFile("D:\DATA\资料\update\data\info")
    If dataLoadSuccess = 2 Then //有作业存在
    	doingWork = load("doingWork", "info")
    	If CInt(load("picFinshed", "info")) = 0 Then//图片下载未完成
    		updateForm.run.Caption = "下载图片"
    		Call getAllPic
    	Else
    		updateForm.tabControl.Tab = 0
        	Call updateAllSub
    	End If
    Else 
    	totalWork = Plugin.Sys.GetCLB()
        workLength = initLocalWork(totalWork)
        Call initWork(0)
        showLog ("资源载入成功,共载入" & workLength & "个条目")

        updateForm.run.Caption = "下载图片"
        updateForm.getLast.Enabled = True
        updateForm.getNext.Enabled = True
    End If
End Sub

//输出日志
Function showLog(newLog)
    totalLog = newLog&vbcrlf&updateForm.infoBox.Text
    updateForm.infoBox.Text = totalLog
End Function

//格式化作业
Function initLocalWork(totalWork)
    works = Split(totalWork, "^^^")
    Call save("workLength", UBound(works), "info")
    Call save("picFinshed", 0, "info")
    For initLocalWorkCount = 0 to UBound(works)-1
        data = Split(works(initLocalWorkCount), "|||")
        Call Plugin.File.CreateFolder("D:\DATA\资料\update\" & initLocalWorkCount)
        Call save("whitePic", 1, initLocalWorkCount)
        For  j = 0 to UBound(data)
            Select Case j
            Case 0
                Call save("url", data(j), initLocalWorkCount)
            Case 1
                Call save("name", data(j), initLocalWorkCount)
                If Len(data(j)) > 18 Then 
                	showLog(">>>>>警报！<<<<< 第" & initLocalWorkCount+1 & "条-标题超过18字")
                End If
            Case 2
                Call save("HL1", data(j), initLocalWorkCount)
                If Len(data(j)) > 20 Then 
                	showLog(">>>>>警报！<<<<< 第" & initLocalWorkCount+1 & "条-长亮点1超过20字")
                End If
            Case 3
                Call save("HL2", data(j), initLocalWorkCount)
                If Len(data(j)) > 20 Then 
                	showLog(">>>>>警报！<<<<< 第" & initLocalWorkCount+1 & "条-长亮点2超过20字")
                End If
            Case 4
                Call save("SHL1", data(j), initLocalWorkCount)
            Case 5
                Call save("SHL2", data(j), initLocalWorkCount)
            Case 6
                Call save("addition1Mode", data(j), initLocalWorkCount)
                If Len(data(j)) > 4 Then 
                	showLog(">>>>>警报！<<<<< 第" & initLocalWorkCount+1 & "条-补充1标题超过4字")
                End If
            Case 7
                Call save("addition1Content", data(j), initLocalWorkCount)
                If Len(data(j)) < 60 Then 
                	showLog(">>>>>警报！<<<<< 第" & initLocalWorkCount+1 & "条-补充1内容不足60字")
                End If
            Case 8
                Call save("addition2Mode", data(j), initLocalWorkCount)
                If Len(data(j)) > 4 Then 
                	showLog(">>>>>警报！<<<<< 第" & initLocalWorkCount+1 & "条-补充2标题超过4字")
                End If
            Case 9
                Call save("addition2Content", data(j), initLocalWorkCount)
                If Len(data(j)) < 60 Then 
                	showLog(">>>>>警报！<<<<< 第" & initLocalWorkCount+1 & "条-补充2内容不足60字")
                End If
            End Select
        Next
    Next
    Call save("doingWork", 0, "info")
    initLocalWork = UBound(works)
End Function

//用于将作业读取并填充至文本框
Function initWork(doingWork)
    updateForm.progressLabel.Caption = "第" & (doingWork+1) & "/" & load("workLength", "info") & "个作业"
    updateForm.urlInput.Text = load("url", doingWork)
    updateForm.titleInput.Text = load("name", doingWork)
    
    updateForm.HL1Input.Text = load("HL1", doingWork)
    updateForm.HL2Input.Text = load("HL2", doingWork)
    updateForm.SHL1Input.Text = load("SHL1", doingWork)
    updateForm.SHL2Input.Text = load("SHL2", doingWork)
    
    updateForm.addition1ModeInput.Text = load("addition1Mode", doingWork)
    updateForm.addition1ContentInput.Text = load("addition1Content", doingWork)
    updateForm.addition2ModeInput.Text = load("addition2Mode", doingWork)
    updateForm.addition2ContentInput.Text = load("addition2Content", doingWork)
End Function

//保存数据及读出数据
Function save(key, value, fileName)
	Call Lib.hps.save(key, value, "D:\DATA\资料\update\data\" & fileName)
End Function
Function load(key, fileName)
	load = Lib.hps.load(key, "D:\DATA\资料\update\data\" & fileName)
End Function

//保存值
Event updateForm.urlInput.LostFocus
    Call save("url", updateForm.urlInput.Text, load("doingWork", "info"))
    Call showLog("已保存链接")
End Event
Event updateForm.TitleInput.LostFocus
    Call save("name", updateForm.TitleInput.Text, load("doingWork", "info"))
    Call showLog("已保存名称")
End Event
Event updateForm.HL1Input.LostFocus
    Call save("HL1", updateForm.HL1Input.Text, load("doingWork", "info"))
    Call showLog("已保存亮点1")
End Event
Event updateForm.HL2Input.LostFocus
    Call save("HL2", updateForm.HL2Input.Text, load("doingWork", "info"))
    Call showLog("已保存亮点2")
End Event
Event updateForm.SHL1Input.LostFocus
    Call save("SHL1", updateForm.SHL1Input.Text, load("doingWork", "info"))
    Call showLog("已保存短亮点1")
End Event
Event updateForm.SHL2Input.LostFocus
    Call save("SHL2", updateForm.SHL2Input.Text, load("doingWork", "info"))
    Call showLog("已保存短亮点2")
End Event
Event updateForm.addition1ModeInput.LostFocus
    Call save("addition1Mode", updateForm.addition1ModeInput.Text, load("doingWork", "info"))
    Call showLog("已保存补充1标题")
End Event
Event updateForm.addition1ContentInput.LostFocus
    Call save("addition1Content", updateForm.addition1ContentInput.Text, load("doingWork", "info"))
    Call showLog("已保存补充1内容")
End Event
Event updateForm.addition2ModeInput.LostFocus
    Call save("addition2Mode", updateForm.addition2ModeInput.Text, load("doingWork", "info"))
    Call showLog("已保存补充2标题")
End Event
Event updateForm.addition2ContentInput.LostFocus
    Call save("addition2Content", updateForm.addition2ContentInput.Text, load("doingWork", "info"))
    Call showLog("已保存补充2内容")
End Event

//选择作业
Event updateForm.getLast.Click
	BeginThread reduceDoingWork
End Event
Sub reduceDoingWork()
	doingWork = load("doingWork", "info")
	If (doingWork-1) < 0 Then 
		Call showLog("已经是第一个条目了")
	Else 
		doingWork = doingWork - 1
		Call save("doingWork", doingWork, "info")
		Call initWork(doingWork)
		If CInt(load("picFinshed", "info")) = 0 Then 
			updateForm.run.Caption = "下载图片"
		End If
		Call showLog("载入完成，当前为第" & (doingWork+1) & "条作业")
	End If
End Sub
Event updateForm.getNext.Click
	BeginThread addDoingWork
End Event

Sub addDoingWork()
	doingWork = load("doingWork", "info")
	workLength = CInt(load("workLength", "info"))
	If (doingWork+1)=workLength And doingWork>workLength Then 
		Call showLog("已经是最后一个条目了")
	Else 
		doingWork = doingWork + 1
		Call save("doingWork", doingWork, "info")
		Call initWork(doingWork)
		If CInt(load("picFinshed", "info")) = 0 Then 
			updateForm.run.Caption = "下载图片"
		End If
		Call showLog("载入完成，当前为第" & (doingWork+1) & "条作业")
	End If
End Sub

//删除所有作业
Event updateForm.deleteData.Click
	updateForm.tabControl.Tab = 0
	updateForm.infoBox.Text = ""
	folders = Lib.文件.遍历指定目录下所有文件夹名("D:\DATA\资料\update")
	For deleteDataCount = 0 To UBound(folders) - 1
		Call Plugin.File.DeleteFolder("D:\DATA\资料\update\"&folders(deleteDataCount))
	Next
	
//	Call Plugin.File.ReNameFile("D:\DATA\资料\update", "D:\DATA\资料\updateBackup")
	Call Plugin.File.CreateFolder("D:\DATA\资料\update")
	Call Plugin.File.CreateFolder("D:\DATA\资料\update\data")
	
	Call initWork(0)
	updateForm.getLast.Enabled = False
    updateForm.getNext.Enabled = False
	Call showLog("作业已删除，请复制新作业")
	updateForm.run.Caption = "新建作业"
End Event

//―――――――――――――――――――――――――――――――――――――――――――――――填充内容―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
Function fillData()	
	doingWork = load("doingWork", "info")
	url = load("url", doingWork)
	name = load("name", doingWork)
	HL1 = load("HL1", doingWork)
	HL2 = load("HL2", doingWork)
	SHL1 = load("SHL1", doingWork)
	SHL2 = load("SHL2", doingWork)
	addition1Mode = load("addition1Mode", doingWork)
	addition1Content = load("addition1Content", doingWork)
	addition2Mode = load("addition2Mode", doingWork)
	addition2Content = load("addition2Content", doingWork)
	
	Call Lib.hps.setFocus("八斗会-添加-新有好货 - UC浏览器")
//	addNewPage = Plugin.Window.Find(0, "八斗会-添加-新有好货 - UC浏览器")
//	Call Plugin.Window.Active(addNewPage)
//	Call Plugin.Window.Max(addNewPage)
	
	Call showLog("完成")
	Call showLog("正在选择自定义分类...")
	Delay 800
	MoveTo 742, 298
	LeftClick 1
	KeyPress "Down", 9
	KeyPress "Enter", 1
	
	Call showLog("完成")
	Call showLog("正在上传外标题...")
	Delay 100

	KeyPress "Tab", 4
	Call Lib.hps.paste(name)
	Call showLog("完成")
	
	Call showLog("正在上传长亮点1...")
	KeyPress "Tab", 4
	Call Lib.hps.paste(HL1)
	Call showLog("完成")
	
	Call showLog("正在上传长亮点2...")
	MoveTo 1199,714//添加新长亮点按钮
	LeftClick 1
	KeyPress "Tab", 1
	Call Lib.hps.paste(HL2)
	Call showLog("完成")
	
	Call showLog("正在上传短亮点1...")
	KeyPress "Tab", 2
	Call Lib.hps.paste(SHL1)
	KeyPress "Enter", 1
	Call showLog("完成")
	
	Call showLog("正在上传短亮点2...")
	Call Lib.hps.paste(SHL2)
	KeyPress "Enter", 1
	Call showLog("完成")
	
	Call showLog("正在选择目标人群...")
	KeyPress "Tab", 3
	KeyPress "Enter", 1
	KeyPress "Down", 9
	KeyPress "Enter", 1
	
	KeyPress "Tab", 1
	KeyPress "Enter", 1
	KeyPress "Down", Lib.hps.getRand(1, 5)
	KeyPress "Enter", 1
	Call showLog("完成")
	
	Call showLog("正在上传补充内容...")
	Call showLog("正在添加新的条目...")
	IfColor 931,862, "5CB85C", 1 Then//自定义段落
		Call alerts("自定义段落位置未知")
	End If
	
	MoveTo 931,862//自定义段落
	LeftClick 1
	
	Call showLog("正在上传补充2...")
	If Plugin.File.IsFileExist("D:\DATA\资料\update\" & doingWork & "\pic (6).jpg") Then 
		Call pasteAddition(855, 932, addition2Mode, addition2Content, "pic (6)")//补充2位置
	Else 
		Call pasteAddition(855, 932, addition2Mode, addition2Content, "pic (5)")//补充2位置
	End If
	Call showLog("完成")
	
	Call showLog("正在上传补充1...")
	If Plugin.File.IsFileExist("D:\DATA\资料\update\" & doingWork & "\pic (6).jpg") Then 
		Call pasteAddition(859, 434, addition1Mode, addition1Content, "pic (5)")//填充补充1
	Else 
		Call pasteAddition(859, 434, addition1Mode, addition1Content, "pic (4)")//填充补充2
	End If
	Call showLog("完成")
	Call showLog("正在打开宝贝详情...")
	KeyPress "Tab", 1
	
	MoveTo 810,480//添加商品按钮
	LeftClick 1
	Call Lib.hps.waitColorShow(1229,579, "5CB85C")//获取商品详情绿
	
	LeftClick 1
	KeyPress "Tab", 1
	Call showLog("完成")
	
	Call showLog("正在上传url...")
	Call Lib.hps.paste(url)
	KeyPress "Tab", 1
	KeyPress "Enter", 1
	
	totalDelayTime = 0
	clickTabNum = 5
	Do
		IfColor 1326, 262, "DEC05B", 0 Then//上方商品库蓝
			Delay 100
			Exit Do 
		Else 
			Delay 200
			totalDelayTime = totalDelayTime + 200
			
			TracePrint totalDelayTime
			If totalDelayTime >= 4000 Then 
				colors = Array("ED8D2F", "EC8C2F", "EC8C2E", "EC8D2F", "F3B77C")
				If Lib.hps.colorShow(1053, 604, colors) Then 
					MoveTo 1030, 622
					LeftClick 1
					clickTabNum = 7
				End If
				
				totalDelayTime = 0
			End If
		End If
	Loop
	Call showLog("完成")
	
	Call showLog("正在上传里标题...")
	KeyPress "Tab", clickTabNum
	Call Lib.hps.paste(name)
	Delay 200
	Call showLog("完成")
	
	//拖动滚动条
	Delay 300
	MoveTo 1537, 250
	LeftDown 1
	MoveTo 1537, 720
	LeftUp 1
	
	//拖动滚动条
	Delay 300
	MoveTo 1550, 250
	LeftDown 1
	MoveTo 1550, 720
	LeftUp 1
	
	Call showLog("正在寻找白底图上传位置...")
	openPicUpdate = false
	For i = 0 To 9//依次点击找到白底图上传位置
		picX = 466 + (108 * i)
		MoveTo picX, 625
		LeftClick 1
		
		For 2
			IfColor 0, 400, "787575", 0 Then
				openPicUpdate = true
			Else 
				LeftClick 1
				Delay 500
			End If
		Next
		
		If openPicUpdate Then 
			Exit For
		End If
	Next
	Call showLog("完成")
	
	Call showLog("正在上传白底图...")
	Call updateNormalPic(0, 0, "pic")//已经打开所以是0, 0
	Call showLog("完成")
	Call showLog("正在上传介绍图1...")
	
	Call updateIntroducePic(466, 792, "pic")
	Call showLog("完成")
	
	Call showLog("正在上传介绍图2...")
	Call updateIntroducePic(570, 792, "pic (2)")
	Call showLog("完成")
	
	Call showLog("正在上传介绍图3...")
	Call updateIntroducePic(685, 792, "pic (3)")
	Call showLog("完成")
	
	If Plugin.File.IsFileExist("D:\DATA\资料\update\" & doingWork & "\pic (6).jpg") Then 
		Call showLog("正在上传介绍图4...")
		Call updateIntroducePic(793, 792, "pic (4)")
		Call showLog("完成")
	End If
	
	Delay 200
	MoveTo 1298, 904//确认详情页按钮
	LeftClick 1
	
	Call Lib.hps.waitColorShow(0, 500, "F3EEEC")
	
	Call ShowLog("上传完成")
End Function

//警告
Function alerts(content)
	Call Plugin.Media.Beep(880, 800)
	MsgBox "警报！ " & content
	EndScript 
End Function

Function waitColor(x, y, ColorCode)
	Do
		IfColor x, y , ColorCode, 0 Then
			Delay 300
			Exit Do
		Else 
			Delay 100
		End If
	Loop
End Function

Function pasteTo(x, y, str)//在指定坐标粘贴文本
	MoveTo x, y
	LeftClick 1
	Call paste(str)
End Function

Function paste(str)//直接粘贴文本
	KeyDown "Ctrl", 1
	KeyPress "A", 1
	KeyUp "Ctrl", 1
	Call Plugin.Sys.SetCLB(str)
	KeyDown "Ctrl", 1
	KeyPress "V", 1
	KeyUp "Ctrl", 1
	Delay 200
End Function
//―――――――――――――――――――――――――――――――――――――――――――――――粘贴补充内容―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
Function pasteAddition(x, y, title, content, picName)
	MoveTo x, y
	LeftClick 1
	Call Lib.hps.waitColorShow(502,422, "F5F5F5")//段落描述后灰
	
	MoveTo 833,848//右侧空白
	LeftClick 1
	KeyPress "Tab", 1
	Call Lib.hps.paste(title)
	KeyPress "Tab", 1
	Call Lib.hps.paste(content)
	
	Delay 300
	Call updateNormalPic(487, 734, picName)
	
	MoveTo 616,850//蓝色确认按钮
	LeftClick 1
	
	Call Lib.hps.waitColorShow(170, 424, "F3EEEC")//网页左侧灰
End Function

//上传单个图片
Function updatePic(x, y, picName)
	Delay 200
	MoveTo x, y
	//点击在下方的循环中
	Do
		IfColor 800, 330, "F7EDD9", 0 Then//点击虚线内空白处蓝
			Delay 300
			Exit Do
		Else 
			LeftClick 1
			Delay 300
		End If
	Loop
	
	doingWork = load("doingWork", "info")
	Call Lib.hps.selectPic(567, 406, "D:\DATA\资料\update\" & doingWork & "\" & picName & ".jpg")
	
//	MoveTo 567, 406//上传按钮
//	LeftClick 1
//	Do//打开图片窗口出现
//		openFileHwnd = Plugin.Window.Find(0, "打开")
//		If Plugin.Window.IsWindow(openFileHwnd) = 0 Then
//        	Delay 200
//    	Else
//    		Exit Do
//    	End If
//	Loop
//	Delay 500
//	
//	Call Plugin.Window.Active(openFileHwnd)
//	Call Plugin.Window.Max(openFileHwnd)
//
//	KeyPress "BackSpace", 1
//	doingWork = load("doingWork", "info")
//	Call Lib.hps.paste("D:\DATA\资料\update\" & doingWork & "\" & picName & ".jpg")
//	KeyPress "Enter", 1//回车确认选择图片
//	
//	totalWaitTime = 0
//	Do//等待选择图片对话框关闭
//		IfColor 100, 1000, "F0F0F0", 0 Then//选择框下方浅灰色
//       		Delay 200
//       		totalWaitTime = totalWaitTime + 200
//       		Call showLog("正在等待上传对话框关闭-"&totalWaitTime)
//       		If totalWaitTime > 1000 Then 
//       			Call showLog("开始纠错")
//       			MoveTo 550,550//图片主窗口
//				LeftClick 1
//				KeyPress "Tab", 1
//
//				KeyDown "Ctrl", 1
//				KeyPress "A", 1
//				KeyUp "Ctrl", 1
//				KeyPress "BackSpace", 1
//
//       			Call Lib.hps.paste("D:\DATA\资料\update\" & doingWork & "\" & picName & ".jpg")
//       			KeyPress "Enter", 1//回车确认选择图片
//       			totalWaitTime = 0
//       		End If
//     	Else
//    		Exit Do
//    	End If
//	Loop//选择图片对话框关闭
	
	Delay 500
	MoveTo 682, 406//上传按钮
	LeftClick 1
End Function

//上传普通图
Function updateNormalPic(x, y, picName)
	Call updatePic(x, y, picName)
	
	Delay 800
	Call Lib.hps.waitColorHide(0, 500, "181717")//子窗口标题栏灰
	//图片上传完成
	Delay 300
End Function

//上传介绍图
Function updateIntroducePic(x, y, picName)
	Call updatePic(x, y, picName)
	
	Call Lib.hps.waitColorShow(1022, 862, "5CB85C")//下方确认按钮
	Delay 500
	MoveTo 1022, 862
	LeftClick 1
	
	Call Lib.hps.waitColorShow(474,203, "F8F8F8")//子窗口标题栏灰
	Delay 300
End Function

Function getRand(min, max)//获取随机数
   	Randomize
    getRand = CInt(Rnd*(max-min) + min)
End Function

//―――――――――――――――――――――――――――――――――――――――――――――――删除图片―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
Sub deletePic(doingWork)
	Call deleteFileInFolder("D:\DATA\资料\picDownload")
	Call deleteFileInFolder("D:\DATA\资料\update\" & doingWork)
End Sub

Function deleteFileInFolder(path)
	files = Lib.文件.遍历指定目录下所有文件名(path)
	For deleteFileInFolderCount = 0 To UBound(files)-1
		Call Plugin.File.DeleteFile(path&"\"&files(deleteFileInFolderCount))
	Next
End Function

//―――――――――――――――――――――――――――――――――――――――――――――――下载全部图片―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
Sub getAllPic()
	workLength = load("workLength", "info")
	doingWork = load("doingWork", "info")
	For getAllPicCount = doingWork To workLength - 1
		Call downloadPic(getAllPicCount)
		Call handlePic(getAllPicCount)
		Call addDoingWork
	Next
	Call save("picFinshed", 1, "info")
	Call save("doingWork", 0, "info")
	Call initWork(0)
	updateForm.run.Caption = "上传条目"
	Call showLog("图片下载完成，点击按钮开始上传")
	
	Call Lib.hps.setFocus("八斗会-添加-新有好货 - UC浏览器")
	
	Call Plugin.Media.Beep(523, 200)
	Call Plugin.Media.Beep(262, 200)
End Sub

//―――――――――――――――――――――――――――――――――――――――――――――――下载图片―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
Function downloadPic(doingWork)
	AnimDelay = 700//哇掌柜淡入淡出动画的时长
	downloadPath = "D:\DATA\资料\picDownload"
	url = load("url", doingWork)
	
	Call Lib.hps.setFocus("八斗会-添加-新有好货 - UC浏览器")
	
	Delay 500
	MouseWheel 5
	Delay 400
	IfColor 1203,198, "F8F8F8", 0 Then//上方小标题栏灰
		MoveTo 1170,250//url栏
		LeftClick 1
		//ctrl+a
		KeyDown 17, 1
		KeyPress 65, 1
		KeyUp 17, 1
		KeyPress "BackSpace", 1
		
		Call Lib.hps.paste(url)
		KeyPress "Tab", 1
		KeyPress "Enter", 1
	Else 
		MoveTo 810,480//添加商品按钮
		LeftClick 1
		Call Lib.hps.waitColorShow(1229,579, "5CB85C")//获取商品详情绿
		
		LeftClick 1
		KeyPress "Tab", 1
		Call Lib.hps.paste(url)
		KeyPress "Tab", 1
		KeyPress "Enter", 1
	End If
	RunApp url
	Delay 800
	
	Call Lib.hps.setFocus("八斗会-添加-新有好货 - UC浏览器")
	
	//将文件夹中有可能存在的图片删除
	Call deletePic(doingWork)
	
	//等待下载的数量多达5个继续
	Do
		If isPicDownload() Then 
			Delay 500
			Exit Do
		Else 
			Delay 200
		End If
	Loop
	
	Call showLog("五张图片下载完成")
End Function

Function showFolderFile(Path)
	files = Lib.文件.遍历指定目录下所有文件名(Path)
	For showFolderFileCount = 0 To UBound(files) - 1
		TracePrint files(showFolderFileCount)
	Next
End Function

Function isPicDownload()
	downloadPath = "D:\DATA\资料\picDownload"
	files = Lib.文件.遍历指定目录下所有文件名(downloadPath)
	If UBound(files) >= 6 Then 
		//TracePrint "图片数量已经超过5个了"
		For isPicDownloadCount = 0 To UBound(files) - 1
			names = split(files(isPicDownloadCount), ".")
			suffix = names(UBound(names))
			//TracePrint "后缀是" & suffix
			If instr(suffix, "png") = 0 And instr(suffix, "jpg") = 0 Then 
				//TracePrint "它不是png或者jpg"
				If instr(suffix, "SS2") = 0 And instr(suffix, "ss2") = 0 Then 
					//TracePrint "它也不是ss2"
					isPicDownload = False
					Exit Function
				Else 
					//TracePrint "它是ss2"
					picName = ""
					For j = 0 To UBound(names) - 1
						picName = picName&names(j)
					Next
					picName = picName & ".jpg"
					Call Plugin.File.ReNameFile(downloadPath &"\"& files(isPicDownloadCount), downloadPath &"\"&picName)
				End If
			End If
		Next
		//TracePrint "图片已经下载好了"
		isPicDownload = True
	Else 
		isPicDownload = False
	End If
End Function

//―――――――――――――――――――――――――――――――――――――――――――――――处理图片―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――

Function handlePic(doingWork)
	Call showLog("正在处理图片")
	downloadPath = "D:\DATA\资料\picDownload"
	//若有png则蜂鸣
	files = Lib.文件.遍历指定目录下所有文件名(downloadPath)
	For handlePicCount = 0 To UBound(files) - 1
		names = split(files(handlePicCount), ".")
		suffix = names(UBound(names))
		If instr(suffix, "png") <> 0 Then 
			Call Plugin.Media.Beep(988, 400)
			Exit For
		End If
	Next
	
	//打开美图秀秀
	MTXX = Plugin.Window.Find(0, "美图秀秀")
	Call Plugin.Window.Active(MTXX)
	Call Plugin.Window.Max(MTXX)
	
	Delay 500
	
	IfColor 891,278, "DA9F63", 0 Then//保存和分享界面已经打开的话
//		MoveTo 746,493//打开
	Else
		MoveTo 1704, 53//打开
	End If
	LeftClick 1
	
	MsgBox "确认完成后点击确定继续"
	
//	//等待文件夹打开
//	Do
//		ExplorerHwnd = Plugin.Window.Find(0, "picDownload")
//		sWindow = Plugin.Window.IsWindow(ExplorerHwnd)
//		If sWindow = 1 Then 
//			//TracePrint "start"
//			Exit Do 
//		End If
//	Loop
//	//文件夹关闭则继续
//	Do
//		ExplorerHwnd = Plugin.Window.Find(0, "picDownload")
//		sWindow = Plugin.Window.IsWindow(ExplorerHwnd)
//		If sWindow = 0 Then 
//			//TracePrint "exit"
//			Exit Do 
//		End If
//	Loop 

	//移动图片
	pics = Lib.文件.遍历指定目录下所有文件名(downloadPath)
	For confirmPicCount = 0 To UBound(pics)
		Call Plugin.File.MoveFile(downloadPath & "\" & pics(confirmPicCount), "D:\DATA\资料\update\" & doingWork & "\" & pics(confirmPicCount))
	Next
	
	Call showLog("第" & (doingWork + 1) & "个条目的图片处理完成")
End Function

Event updateForm.Button1.Click
	doingWork = load("doingWork", "info")
	RunApp "D:\DATA\资料\update\data\"&doingWork
End Event

Event updateForm.resetDoingWorkBtn.Click
	fileExist = Plugin.File.ExistFile("D:\DATA\资料\update\data\info")
    If fileExist = 2 Then
    	Call save("doingWork", 0, "info")
		Call initWork(0)
		Call showLog("载入完成，当前为第" & (0+1) & "条作业")
    End If
End Event

Event updateForm.updateSingle.Click
	BeginThread updateSingle
End Event

Sub updateSingle
	Call showLog(">>条目" & (doingWork + 1) & "上传中...")
    Call fillData
    
    workLength = CInt(load("workLength", "info"))
	If (doingWork+1)=workLength And doingWork>workLength Then
		Call showLog(">>>>>>>>>作业已经全部完成！<<<<<<<<<")
	Else
		doingWork = doingWork + 1
		Call save("doingWork", doingWork, "info")
		Call initWork(doingWork)
		Call showLog("载入完成，当前为第" & (doingWork+1) & "条作业")
	End If
End Sub

Sub updateAllSub
	workLength = load("workLength", "info")
	workLength = CInt(workLength)
	doingWork = load("doingWork", "info")
	doingWork = CInt(doingWork)
	
	Call Lib.hps.setFocus("八斗会-添加-新有好货 - UC浏览器")
	
	Delay 500
	MouseWheel 15
	Delay 300
	
	For updateAllSubCount = doingWork To workLength - 1
		Call Lib.hps.waitColorShow(456, 398, "FFF6EF")//左边发布新作品蓝
		Delay 200

		Call fillData
		
		MoveTo 1540, 975//保存草稿按钮
		Delay 100
		LeftClick 1
		
		Call Lib.hps.waitColorShow(0, 500, "B3B3B3")
		
		If updateAllSubCount >= (workLength - 1) Then 	
			MoveTo 1155, 625//查看内容列表
			Call showLog("作业上传完成")
		Else
			MoveTo 1046, 626//添加新内容按钮
			
			doingWork = doingWork + 1
			Call save("doingWork", doingWork, "info")
			Call initWork(doingWork)
			Call showLog("载入完成，当前为第" & (doingWork + 1) & "条作业")
		End If
		
		Delay 200
		LeftClick 1
	Next
	
	Call Plugin.Media.Beep(1976, 50)
	Delay 50
	Call Plugin.Media.Beep(1976, 50)
End Sub
Event updateForm.getPos.Click
	If WaitClick = 32777 Then 
		GetCursorPos needX, needY
		MsgBox needX & " , " & needY
		Call Plugin.Sys.SetCLB(needX & "," & needY)
	End If
End Event
