[General]
SyntaxVersion=2
BeginHotkey=0
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=121
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=ab8b61a0-a8c5-4649-a91c-3ad136be6561
Description=上传-哇掌柜
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=updateForm
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
Event updateForm.Load
	Call Plugin.File.CreateFolder("D:\DATA")
	Call Plugin.File.CreateFolder("D:\DATA\资料")
	Call Plugin.File.CreateFolder("D:\DATA\资料\update")
	Call Plugin.File.CreateFolder("D:\DATA\资料\update\data")
	Call Plugin.File.CreateFolder("D:\DATA\资料\picDownload")
	Call Plugin.Window.Top(updateForm.Hwnd, 0)
    fileExist = Plugin.File.ExistFile("D:\DATA\资料\update\data\info")
    If fileExist = 2 Then 
    	If CInt(load("picFinshed", "info")) = 0 Then 
    		doingWork = CInt(load("doingWork", "info"))
    		Call showLog("已读取第" & (doingWork + 1) & "个条目")
    		updateForm.run.Caption = "下载图片"
    		Call initWork(doingWork)
    	Else 
    		doingWork = CInt(load("doingWork", "info"))
        	Call showLog("已读取第"&(doingWork+1)&"个条目")
        	Call initWork(doingWork)
    	End If
    Else 
        Call showLog("请复制作业并点击新建作业按钮")
        updateForm.run.Caption = "新建作业"
        updateForm.getLast.Enabled = False
        updateForm.getNext.Enabled = False
    End If
End Event

Event updateForm.run.Click
    BeginThread runClickEvent()
End Event

Sub runClickEvent()
    dataLoadSuccess = Plugin.File.ExistFile("D:\DATA\资料\update\data\info")
    If dataLoadSuccess = 2 Then //有作业存在
    	doingWork = load("doingWork", "info")
    	If CInt(load("picFinshed", "info")) = 0 Then//图片下载未完成
    		updateForm.run.Caption = "下载图片"
    		Call getAllPic
    	Else
    		updateForm.tabControl.Tab = 0
        	Call updateAllSub
    	End If
    Else 
    	totalWork = Plugin.Sys.GetCLB()
        workLength = initLocalWork(totalWork)
        Call initWork(0)
        showLog ("资源载入成功,共载入" & workLength & "个条目")
        updateForm.run.Caption = "下载图片"
        updateForm.getLast.Enabled = True
        updateForm.getNext.Enabled = True
    End If
End Sub

//输出日志
Function showLog(newLog)
    totalLog = newLog&vbcrlf&updateForm.infoBox.Text
    updateForm.infoBox.Text = totalLog
End Function

//格式化作业
Function initLocalWork(totalWork)
    works = Split(totalWork, "^^^")
    Call save("workLength", UBound(works), "info")
    Call save("picFinshed", 0, "info")
    For initLocalWorkCount = 0 to UBound(works)-1
        data = Split(works(initLocalWorkCount), "|||")
        Call Plugin.File.CreateFolder("D:\DATA\资料\update\" & initLocalWorkCount)
        Call save("whitePic", 1, initLocalWorkCount)
        For  j = 0 to UBound(data)
            Select Case j
            Case 0
                Call save("url", data(j), initLocalWorkCount)
            Case 1
                Call save("name", data(j), initLocalWorkCount)
            Case 2
                Call save("HL1", data(j), initLocalWorkCount)
            Case 3
                Call save("HL2", data(j), initLocalWorkCount)
            Case 4
                Call save("SHL1", data(j), initLocalWorkCount)
            Case 5
                Call save("SHL2", data(j), initLocalWorkCount)
            Case 6
                Call save("addition1Mode", data(j), initLocalWorkCount)
            Case 7
                Call save("addition1Content", data(j), initLocalWorkCount)
            Case 8
                Call save("addition2Mode", data(j), initLocalWorkCount)
            Case 9
                Call save("addition2Content", data(j), initLocalWorkCount)
            End Select
        Next
    Next
    Call save("doingWork", 0, "info")
    initLocalWork = UBound(works)
End Function

//用于将作业读取并填充至文本框
Function initWork(doingWork)
	updateForm.run.Caption = "上传作业"
	
    updateForm.progressLabel.Caption = "第" & (doingWork+1) & "/" & load("workLength", "info") & "个作业"
    updateForm.urlInput.Text = load("url", doingWork)
    updateForm.titleInput.Text = load("name", doingWork)
    
    updateForm.HL1Input.Text = load("HL1", doingWork)
    updateForm.HL2Input.Text = load("HL2", doingWork)
    updateForm.SHL1Input.Text = load("SHL1", doingWork)
    updateForm.SHL2Input.Text = load("SHL2", doingWork)
    
    updateForm.addition1ModeInput.Text = load("addition1Mode", doingWork)
    updateForm.addition1ContentInput.Text = load("addition1Content", doingWork)
    updateForm.addition2ModeInput.Text = load("addition2Mode", doingWork)
    updateForm.addition2ContentInput.Text = load("addition2Content", doingWork)
End Function

//保存数据及读出数据
Function save(key, value, fileName)
	If Plugin.File.ExistFile("D:\DATA\资料\update\data\" & fileName) = 0 Then
		Call Plugin.File.CreateFolder("D:\DATA\资料\update\data\" & fileName)
	End If
	If Plugin.File.ExistFile("D:\DATA\资料\update\data\" & fileName & "\" & key) = 1 Then
		Call Plugin.File.DeleteFile("D:\DATA\资料\update\data\" & fileName & "\" & key)
	End If
	Call Plugin.File.WriteFileEx("D:\DATA\资料\update\data\" & fileName & "\" & key, value)
End Function
Function load(key, fileName)
	loadContent = ""
	loadStr = Plugin.File.ReadFileEx("D:\DATA\资料\update\data\" & fileName & "\" & key)
	strs = split(loadStr, "|")
	For loadI=0 To UBound(strs)
		loadContent = loadContent&strs(loadI)
	Next
    load = loadContent
End Function

//保存值
Event updateForm.urlInput.LostFocus
    Call save("url", updateForm.urlInput.Text, load("doingWork", "info"))
    Call showLog("已保存链接")
End Event
Event updateForm.TitleInput.LostFocus
    Call save("name", updateForm.TitleInput.Text, load("doingWork", "info"))
    Call showLog("已保存名称")
End Event
Event updateForm.HL1Input.LostFocus
    Call save("HL1", updateForm.HL1Input.Text, load("doingWork", "info"))
    Call showLog("已保存亮点1")
End Event
Event updateForm.HL2Input.LostFocus
    Call save("HL2", updateForm.HL2Input.Text, load("doingWork", "info"))
    Call showLog("已保存亮点2")
End Event
Event updateForm.SHL1Input.LostFocus
    Call save("SHL1", updateForm.SHL1Input.Text, load("doingWork", "info"))
    Call showLog("已保存短亮点1")
End Event
Event updateForm.SHL2Input.LostFocus
    Call save("SHL2", updateForm.SHL2Input.Text, load("doingWork", "info"))
    Call showLog("已保存短亮点2")
End Event
Event updateForm.addition1ModeInput.LostFocus
    Call save("addition1Mode", updateForm.addition1ModeInput.Text, load("doingWork", "info"))
    Call showLog("已保存补充1标题")
End Event
Event updateForm.addition1ContentInput.LostFocus
    Call save("addition1Content", updateForm.addition1ContentInput.Text, load("doingWork", "info"))
    Call showLog("已保存补充1内容")
End Event
Event updateForm.addition2ModeInput.LostFocus
    Call save("addition2Mode", updateForm.addition2ModeInput.Text, load("doingWork", "info"))
    Call showLog("已保存补充2标题")
End Event
Event updateForm.addition2ContentInput.LostFocus
    Call save("addition2Content", updateForm.addition2ContentInput.Text, load("doingWork", "info"))
    Call showLog("已保存补充2内容")
End Event

//选择作业
Event updateForm.getLast.Click
	BeginThread reduceDoingWork
End Event
Sub reduceDoingWork()
	doingWork = load("doingWork", "info")
	If (doingWork-1) < 0 Then 
		Call showLog("已经是第一个条目了")
	Else 
		doingWork = doingWork - 1
		Call save("doingWork", doingWork, "info")
		Call initWork(doingWork)
		If CInt(load("picFinshed", "info")) = 0 Then 
			updateForm.run.Caption = "下载图片"
		End If
		Call showLog("载入完成，当前为第" & (doingWork+1) & "条作业")
	End If
End Sub
Event updateForm.getNext.Click
	BeginThread addDoingWork
End Event
Sub addDoingWork()
	doingWork = load("doingWork", "info")
	workLength = CInt(load("workLength", "info"))
	If (doingWork+1)=workLength And doingWork>workLength Then 
		Call showLog("已经是最后一个条目了")
	Else 
		doingWork = doingWork + 1
		Call save("doingWork", doingWork, "info")
		Call initWork(doingWork)
		If CInt(load("picFinshed", "info")) = 0 Then 
			updateForm.run.Caption = "下载图片"
		End If
		Call showLog("载入完成，当前为第" & (doingWork+1) & "条作业")
	End If
End Sub

//删除所有作业
Event updateForm.deleteData.Click
	updateForm.tabControl.Tab = 0
	updateForm.infoBox.Text = ""
	folders = Lib.文件.遍历指定目录下所有文件夹名("D:\DATA\资料\update")
	For deleteDataCount = 0 To UBound(folders) - 1
		Call Plugin.File.DeleteFolder("D:\DATA\资料\update\"&folders(deleteDataCount))
	Next
	
//	Call Plugin.File.ReNameFile("D:\DATA\资料\update", "D:\DATA\资料\updateBackup")
	Call Plugin.File.CreateFolder("D:\DATA\资料\update")
	Call Plugin.File.CreateFolder("D:\DATA\资料\update\data")
	
	Call initWork(0)
	updateForm.getLast.Enabled = False
    updateForm.getNext.Enabled = False
	Call showLog("作业已删除，请复制新作业")
	updateForm.run.Caption = "新建作业"
End Event

//―――――――――――――――――――――――――――――――――――――――――――――――填充内容―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
Function fillData()
	AnimDelay = 700//哇掌柜淡入淡出动画的时长
	
	doingWork = load("doingWork", "info")
	url = load("url", doingWork)
	name = load("name", doingWork)
	HL1 = load("HL1", doingWork)
	HL2 = load("HL2", doingWork)
	SHL1 = load("SHL1", doingWork)
	SHL2 = load("SHL2", doingWork)
	addition1Mode = load("addition1Mode", doingWork)
	addition1Content = load("addition1Content", doingWork)
	addition2Mode = load("addition2Mode", doingWork)
	addition2Content = load("addition2Content", doingWork)
	
	addNewPage = Plugin.Window.Find(0, "添加好货 - UC浏览器")
	Call Plugin.Window.Active(addNewPage)
	Call Plugin.Window.Max(addNewPage)
	
	Delay 500
	MouseWheel 15
	Delay 300
	
	MoveTo 457,600//添加链接
	LeftClick 1
	
	Call waitColor(319,232, "68553E")
	Call pasteTo(807, 271, url)//商品链接
	
	Call waitColor(828, 319, "B77A33")
	Call pasteTo(929,368, name)//粘贴里标题

	Call showLog("填入标题与链接")
	Call updatePic(657, 435, "pic")//上传白底图
	//检查白底图是否上传完成
	oldColor = GetPixelColor(662, 489)
	totalWaitTime = 0
	Do
		IfColor 662, 489, oldColor, 1 Then
			Delay 1200
			Exit Do
		Else 
			If totalWaitTime < 5000 Then 
				Delay 100
				totalWaitTime = totalWaitTime + 100
			Else 
				Exit Do
			End If
		End If
	Loop
	
	
	Call waitColor(828, 319, "B77A33")
	Call updatePic(615, 657, "pic")//上传介绍图1
//	Do
//		IfColor 828,319, "B77A33", 0 Then
//			Delay 3000
//			Call updatePic(615, 657, "pic")//上传介绍图1
//			Exit Do
//		Else 
//			Delay 100
//		End If
//	Loop
	Call showLog("介绍图1上传完成")
	
	Call waitColor(828, 319, "B77A33")
	Call updatePic(755,658, "pic (2)")//上传介绍图2
	Call showLog("介绍图2上传完成")
	
	Call waitColor(828, 319, "B77A33")
	Call updatePic(909, 657, "pic (3)")//上传介绍图3
	Call showLog("介绍图3上传完成")
	
	If Plugin.File.IsFileExist("D:\DATA\资料\update\" & doingWork & "\pic (6).jpg") Then 
		Call waitColor(828, 319, "B77A33")
		Call updatePic(1064, 657, "pic (4)")//上传介绍图4
		Call showLog("介绍图4上传完成")
	End If

	//点击提交
	Do
		IfColor 949,848, "B77A33", 0 Then
			Delay 200
			MoveTo 949,848
			LeftClick 1
			Exit Do
		Else 
			Delay 100
		End If
		IfColor 949,848, "906028", 0 Then
			Delay 200
			MoveTo 949,848
			LeftClick 1
			Exit Do
		Else 
			Delay 100
		End If
	Loop
	Delay AnimDelay
	
	Call showLog("点击潮女按钮")
	MoveTo 373,300//潮女按钮
	LeftClick 1
	Delay 300
	
	Call showLog("开始上传标题")
	KeyPress "Tab", 2
	Call paste(name)//标题
	
	//第一次向下卷屏-至亮点
	MouseWheel - 10 
	Delay 400
	
	Call showLog("确定目标人群")
	MoveTo 412,668//目标人群选项1
	Delay 100
	LeftClick 1
	MoveTo 455,708//频道推荐人群
	LeftClick 1
	MoveTo 500,672//目标人群选项2
	Delay 100
	LeftClick 1
	randY = getRand(0, 2)
	MoveTo 500, (710 + (randY*25))//随机选择选项2
	LeftClick 1
	
	Call showLog("开始上传长亮点")
	//点开长亮点次级菜单
	MoveTo 420,196
	LeftClick 1
	Delay AnimDelay
	MoveTo 752,314//添加第一个亮点
	LeftClick 1
	Delay 100
	MoveTo 752,481//添加第二个亮点
	LeftClick 1
	Delay 100
	//粘贴长亮点
	KeyPress "Tab", 2
	Call paste(HL1)//长亮点1
	KeyPress "Tab", 1
	Call paste(HL2)//长亮点2
	MoveTo 1127, 720//确定亮点
	LeftClick 1
	Delay AnimDelay
	
	Call showLog("开始上传短亮点")
	//粘贴短亮点
	MoveTo 492,631//添加第一个短亮点
	LeftClick 1
	MoveTo 742,631//添加第二个短亮点
	LeftClick 1
	Call pasteTo(492,631, SHL1)//短亮点1
	KeyPress "Tab", 1
	Call paste(SHL2)//短亮点2
	
	Call showLog("添加标准段落")
	MoveTo 514, 530//添加标准段落
	LeftClick 1
	Delay 200
	KeyPress "Tab", 1
	KeyPress "Enter", 1
	
//	IfColor 638,610 , "5CB85C", 0 Then
//		MoveTo 638,610 //添加标准段落2 
//	Else
//		MoveTo 749, 940//添加标准段落2 
//	End If
//	Delay 800
//	LeftClick 1
	Delay 200
	
	Call showLog("开始上传标准段落")
	If Plugin.File.IsFileExist("D:\DATA\资料\update\" & doingWork & "\pic (6).jpg") Then 
		Call pasteAddition(749, 940, addition2Mode, addition2Content, "pic (6)", 1)//填充补充2
	Else 
		Call pasteAddition(749, 940, addition2Mode, addition2Content, "pic (5)", 1)//填充补充2
	End If
	
	Call waitColor(186, 456, "DC9835")//左侧创建内容蓝色
	
	If Plugin.File.IsFileExist("D:\DATA\资料\update\" & doingWork & "\pic (6).jpg") Then 
		Call pasteAddition(500, 450, addition1Mode, addition1Content, "pic (5)", 0)//填充补充1
	Else 
		Call pasteAddition(500, 450, addition1Mode, addition1Content, "pic (4)", 0)//填充补充2
	End If
	
	Call waitColor(186,456 , "DC9835")//左侧创建内容蓝色
	
	KeyPress "Tab", 24
	Delay 100
	KeyPress "Enter", 1
	KeyPress "Tab", 2
	Delay 100
	KeyPress "Enter", 1
	
	Call ShowLog("上传完成")
End Function

Function waitColor(x, y, ColorCode)
	Do
		IfColor x, y , ColorCode, 0 Then
			Delay 300
			Exit Do
		Else 
			Delay 100
		End If
	Loop
End Function

Function pasteTo(x, y, str)//在指定坐标粘贴文本
	MoveTo x, y
	LeftClick 1
	Call paste(str)
End Function

Function paste(str)//直接粘贴文本
	KeyDown "Ctrl", 1
	KeyPress "A", 1
	KeyUp "Ctrl", 1
	Call Plugin.Sys.SetCLB(str)
	KeyDown "Ctrl", 1
	KeyPress "V", 1
	KeyUp "Ctrl", 1
	Delay 200
End Function
//―――――――――――――――――――――――――――――――――――――――――――――――粘贴补充内容―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
Function pasteAddition(x, y, title, content, picName, deletePicY)
	MoveTo x, y
	LeftClick 2
	Delay AnimDelay
	KeyDown "Tab", 2
	Call paste(title)//输入标题
	KeyDown "Tab", 1
	
	If deletePicY = 0 Then //设计亮点需要多点一下
		KeyDown "Tab", 1
	End If
	
	Call paste(content)//输入内容
//	MoveTo 785, deletePicY//删除占位图 
//	LeftClick 1
	Do
		IfColor 794,632, "FFFFFF", 0 Then
			Delay 200
			Call updatePic(794,632, picName)
			Exit Do
		Else
			Delay 100
		End If
	Loop
	Do
		IfColor 1096,785, "B77A33", 0 Then//右下补充蓝
			Delay 200
			MoveTo 1096,785//确认补充
			LeftClick 2
			Exit Do
		Else 
			Delay 100
		End If
	Loop
	Delay AnimDelay
End Function
//―――――――――――――――――――――――――――――――――――――――――――――――上传单个图片―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
Function updatePic(x, y, picName)
	MoveTo x, y
	//点击在下方的循环中
	Do
		IfColor 582,282, "F7EDD9", 0 Then//点击虚线内空白处即可上传图片蓝
			Exit Do
		Else 
			LeftClick 1
			Delay 200
		End If
	Loop
	
	MoveTo 944,452//上传按钮
	LeftClick 1
	Do//打开图片窗口出现
		openFileHwnd = Plugin.Window.Find(0, "打开")
		If Plugin.Window.IsWindow(openFileHwnd)=0 Then
        	Delay 200
    	Else
    		Exit Do
    	End If
	Loop
	Delay 500
	
	Call Plugin.Window.Active(openFileHwnd)
	KeyPress "BackSpace", 1
	doingWork = load("doingWork", "info")
	Call paste("D:\DATA\资料\update\"&doingWork&"\"&picName&".jpg")
	KeyPress "Enter", 1//回车确认选择图片
	
	totalWaitTime = 0
	Do//等待选择图片对话框关闭
		IfColor 756,971, "F0F0F0", 0 Then//选择框下方浅灰色
       		Delay 200
       		totalWaitTime = totalWaitTime + 200
       		Call showLog("正在等待上传对话框关闭-"&totalWaitTime)
       		If totalWaitTime > 1000 Then 
       			Call showLog("开始纠错")
       			MoveTo 876,931//图片地址框
				LeftClick 2
				KeyDown "Ctrl", 1
				KeyPress "A", 1
				KeyUp "Ctrl", 1
       			Call paste("D:\DATA\资料\update\" & doingWork & "\" & picName & ".jpg")
       			KeyPress "Enter", 1//回车确认选择图片
       			totalWaitTime = 0
       		End If
     	Else
    		Exit Do
    	End If
	Loop//图片上传完成
	Do//等待上传完成
		IfColor 548,358, "01CBFE", 0 Then//"点击虚线内"左下角浅蓝
       		Delay 200
     	Else 
    		Exit Do
    	End If
	Loop//图片上传完成
	Delay 300
End Function

Function getRand(min, max)//获取随机数
   	Randomize
    getRand = CInt(Rnd*(max-min) + min)
End Function

//―――――――――――――――――――――――――――――――――――――――――――――――删除图片―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
Sub deletePic(doingWork)
	Call deleteFileInFolder("D:\DATA\资料\picDownload")
	Call deleteFileInFolder("D:\DATA\资料\update\" & doingWork)
End Sub

Function deleteFileInFolder(path)
	files = Lib.文件.遍历指定目录下所有文件名(path)
	For deleteFileInFolderCount = 0 To UBound(files)-1
		Call Plugin.File.DeleteFile(path&"\"&files(deleteFileInFolderCount))
	Next
End Function

//―――――――――――――――――――――――――――――――――――――――――――――――下载全部图片―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
Sub getAllPic()
	workLength = load("workLength", "info")
	doingWork = load("doingWork", "info")
	For getAllPicCount = doingWork To workLength - 1
		Call downloadPic(getAllPicCount)
		Call handlePic(getAllPicCount)
		Call addDoingWork
	Next
	Call save("picFinshed", 1, "info")
	Call save("doingWork", 0, "info")
	Call initWork(0)
	Call showLog("图片下载完成，点击按钮开始上传")
	
	addNewPage = Plugin.Window.Find(0, "添加好货 - UC浏览器")
	Call Plugin.Window.Active(addNewPage)
	Call Plugin.Window.Max(addNewPage)
	
	Call Plugin.Media.Beep(523, 200)
	Call Plugin.Media.Beep(262, 200)
End Sub

//―――――――――――――――――――――――――――――――――――――――――――――――下载图片―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
Function downloadPic(doingWork)
	AnimDelay = 700//哇掌柜淡入淡出动画的时长
	downloadPath = "D:\DATA\资料\picDownload"
	url = load("url", doingWork)
	
	addNewPage = Plugin.Window.Find(0, "添加好货 - UC浏览器")
	Call Plugin.Window.Active(addNewPage)
	Call Plugin.Window.Max(addNewPage)
	
	MoveTo 265, 674
	LeftClick 1
	Delay 200
	MouseWheel 15//返回顶部
	Delay 400
	
	IfColor 550, 829, "B77A33", 1 Then
		MoveTo 559, 603//添加链接
		LeftClick 1
		Delay AnimDelay
	End If
	Call pasteTo(807, 271, url)//商品链接
	RunApp url
	//将文件夹中有可能存在的图片删除
	Call deletePic(doingWork)
	
	//等待下载的数量多达5个继续
	Do
		If isPicDownload() Then 
			Delay 500
			Exit Do
		Else 
			Delay 200
		End If
	Loop
	
	Call showLog("五张图片下载完成")
End Function

Function showFolderFile(Path)
	files = Lib.文件.遍历指定目录下所有文件名(Path)
	For showFolderFileCount = 0 To UBound(files) - 1
		TracePrint files(showFolderFileCount)
	Next
End Function

Function isPicDownload()
	downloadPath = "D:\DATA\资料\picDownload"
	files = Lib.文件.遍历指定目录下所有文件名(downloadPath)
	If UBound(files) >= 6 Then 
		//TracePrint "图片数量已经超过5个了"
		For isPicDownloadCount = 0 To UBound(files) - 1
			names = split(files(isPicDownloadCount), ".")
			suffix = names(UBound(names))
			//TracePrint "后缀是" & suffix
			If instr(suffix, "png") = 0 And instr(suffix, "jpg") = 0 Then 
				//TracePrint "它不是png或者jpg"
				If instr(suffix, "SS2") = 0 And instr(suffix, "ss2") = 0 Then 
					//TracePrint "它也不是ss2"
					isPicDownload = False
					Exit Function
				Else 
					//TracePrint "它是ss2"
					picName = ""
					For j = 0 To UBound(names) - 1
						picName = picName&names(j)
					Next
					picName = picName & ".jpg"
					Call Plugin.File.ReNameFile(downloadPath &"\"& files(isPicDownloadCount), downloadPath &"\"&picName)
				End If
			End If
		Next
		//TracePrint "图片已经下载好了"
		isPicDownload = True
	Else 
		isPicDownload = False
	End If
End Function

//―――――――――――――――――――――――――――――――――――――――――――――――处理图片―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――

Function handlePic(doingWork)
	Call showLog("正在处理图片")
	downloadPath = "D:\DATA\资料\picDownload"
	//若有png则蜂鸣
	files = Lib.文件.遍历指定目录下所有文件名(downloadPath)
	For handlePicCount = 0 To UBound(files) - 1
		names = split(files(handlePicCount), ".")
		suffix = names(UBound(names))
		If instr(suffix, "png") <> 0 Then 
			Call Plugin.Media.Beep(988, 400)
			Exit For
		End If
	Next
	
	//RunApp "explorer.exe D:\DATA\资料\picDownload"
	//打开美图秀秀
	MTXX = Plugin.Window.Find(0, "美图秀秀")
	Call Plugin.Window.Active(MTXX)
	Call Plugin.Window.Max(MTXX)
	
	IfColor 891,278, "DA9F63", 0 Then//保存和分享界面已经打开的话
		MoveTo 746,493//打开
	Else
		MoveTo 1704, 53//打开
	End If
	LeftClick 1
	
	MsgBox "确认完成后请点确定"
	
//	//等待文件夹打开
//	Do
//		ExplorerHwnd = Plugin.Window.Find(0, "picDownload")
//		sWindow = Plugin.Window.IsWindow(ExplorerHwnd)
//		If sWindow = 1 Then 
//			//TracePrint "start"
//			Exit Do 
//		End If
//	Loop
//	//文件夹关闭则继续
//	Do
//		ExplorerHwnd = Plugin.Window.Find(0, "picDownload")
//		sWindow = Plugin.Window.IsWindow(ExplorerHwnd)
//		If sWindow = 0 Then 
//			//TracePrint "exit"
//			Exit Do 
//		End If
//	Loop 

	//移动图片
	pics = Lib.文件.遍历指定目录下所有文件名(downloadPath)
	For confirmPicCount = 0 To UBound(pics)
		Call Plugin.File.MoveFile(downloadPath & "\" & pics(confirmPicCount), "D:\DATA\资料\update\" & doingWork & "\" & pics(confirmPicCount))
	Next
	
	Call showLog("第" & (doingWork + 1) & "个条目的图片处理完成")
End Function

Event updateForm.Button1.Click
	doingWork = load("doingWork", "info")
	RunApp "D:\DATA\资料\update\data\"&doingWork
End Event

Event updateForm.resetDoingWorkBtn.Click
	fileExist = Plugin.File.ExistFile("D:\DATA\资料\update\data\info")
    If fileExist = 2 Then
    	Call save("doingWork", 0, "info")
		Call initWork(0)
		Call showLog("载入完成，当前为第" & (0+1) & "条作业")
    End If
End Event

Event updateForm.updateSingle.Click
	BeginThread updateSingle
End Event

Sub updateSingle
	Call showLog(">>条目" & (doingWork + 1) & "上传中...")
    Call fillData
    
    workLength = CInt(load("workLength", "info"))
	If (doingWork+1)=workLength And doingWork>workLength Then
		Call showLog(">>>>>>>>>作业已经全部完成！<<<<<<<<<")
	Else
		doingWork = doingWork + 1
		Call save("doingWork", doingWork, "info")
		Call initWork(doingWork)
		Call showLog("载入完成，当前为第" & (doingWork+1) & "条作业")
	End If
End Sub

Sub updateAllSub
	workLength = load("workLength", "info")
	doingWork = load("doingWork", "info")
	
	addNewPage = Plugin.Window.Find(0, "添加好货 - UC浏览器")
	Call Plugin.Window.Active(addNewPage)
	Call Plugin.Window.Max(addNewPage)
	
	Delay 500
	MouseWheel 15
	Delay 300
	
	For updateAllSubCount = doingWork To workLength - 1
		Do
			IfColor 104, 458, "DC9835", 0 Then//左边创建内容蓝
				Delay 100
				Exit Do
			Else 
				Delay 100
			End If
		Loop

		Call fillData
		
		If doingWork=(workLength-3) Then
			MoveTo 1085, 576//查看内容列表
			
			Call showLog("作业上传完成")
		Else
			MoveTo 984, 578//添加新的内容按钮
			
			doingWork = doingWork + 1
			Call save("doingWork", doingWork, "info")
			Call initWork(doingWork)
			Call showLog("载入完成，当前为第" & (doingWork+1) & "条作业")
		End If
		
		Do
			IfColor 956, 585, "B77A33", 0 Then//添加新的内容蓝
				Delay 300
				LeftClick 1
				Exit Do
			Else 
				Delay 100
			End If
		Loop
	Next
End Sub
Event updateForm.getPos.Click
	If WaitClick = 32777 Then 
		GetCursorPos needX, needY
		MsgBox needX & " , " & needY
		Call Plugin.Sys.SetCLB(needX & "," & needY)
	End If
End Event
